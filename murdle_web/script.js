let casos = [
	{
		titulo: "O MIST√âRIO DO VIG√ÅRIO",
		enredo:
			"O dedutivo Logicus deslocou-se at√© a ex√≥tica cidadezinha da dama Obsidian e imediatamente aprendeu uma nova palavra: 'vig√°rio'. Ele n√£o sabia o que significava, mas sabia como us√°-la numa frase como esta: 'O vig√°rio foi assassinado e vou descobrir quem fez isso.'",
		suspeitos: [
			{
				nome: "DAMA OBSIDIAN",
				icone: "üëí",
				atributos: "1,63 metro ‚Äì Canhota ‚Äì Olhos verdes ‚Äì Cabelo preto",
				bio:
					"Um dos livros mais famosos dela √© sobre um escritor de mist√©rios que arma para uma ilusionista inocente. Suspeito!"
			},
			{
				nome: "Di√°cona Verdigris",
				icone: "üëì",
				atributos: "1,60 metro ‚Äì Canhota ‚Äì Olhos azuis ‚Äì Cabelo grisalho",
				bio:
					"Di√°cona da igreja. Ela toma conta das doa√ß√µes dos paroquianos e, √†s vezes, da vida deles."
			},
			{
				nome: "Earl Grey",
				icone: "‚òï",
				atributos: "1,75 metro ‚Äì Destro ‚Äì Olhos castanho-claros ‚Äì Cabelo branco",
				bio:
					"Vem de uma longa linhagem de Earl Greys. Sim, a do ch√°. N√£o, ele n√£o d√° aut√≥grafos, mas lhe dar√° um saquinho de gra√ßa se voc√™ pedir."
			}
		],
		locais: [
			{
				nome: "A MANS√ÉO",
				icone: "üè†",
				ambiente: "INTERNO",
				descricao:
					"A casa da dama Osidian, cheia de enormes retratos de v√°rias gera√ß√µes de homens brancos ricos j√° mortos."
			},
			{
				nome: "A CAPELA",
				icone: "‚õ™",
				ambiente: "INTERNO",
				descricao: "Uma igreja min√∫scula repleta de vitrais e segredos."
			},
			{
				nome: "AS RU√çNAS ANTIGAS",
				icone: "üèõ",
				ambiente: "EXTERNO",
				descricao:
					"De novo as mesmas pedras! Casa uma dela em um estranho labirinto esculpido na lateral."
			}
		],
		armas: [
			{
				nome: "UM FRASCO DE CIANURETO",
				icone: "üß™",
				peso: "LEVE",
				descricao:
					"√â veneno com odor de am√™ndoa, mas tamb√©m pode dar cabo de dores de cabe√ßa (como o seu marido)."
			},
			{
				nome: "UMA TESOURA DE JARDINAGEM",
				icone: "‚úÇ",
				peso: "M√âDIO",
				descricao:
					"Jardinagem √© um √≥timo hobby, mas, sinceramente, √© mais f√°cil matar algu√©m para conseguir bons tomates."
			},
			{
				nome: "UM NOVELO DE L√É",
				icone: "üß∂",
				peso: "LEVE",
				descricao:
					"√Ås vezes, quando percebemos que pulamos um ponto d√° vontade de estrangular algu√©m."
			}
		],
		pistas: [
			"Logicus sentiu cheiro de am√™ndoa debaixo de um vitral.",
			"A dama Obsidian n√£o estava na mans√£o dela. Nem em qualquer outra, ali√°s.",
			"Sim, Earl Grey era dono de um imp√©rio de ch√°, mas jamais jardinava, e preferia morrer a segurar uma tesoura de jardineiro.",
			"A di√°cona Verdigris andara visitando as ru√≠nas antigas a fim de pesquisar para um artigo sobre as pr√°ticas pag√£s locais anteriores √† chegada da Igreja.",
			"O vig√°rio foi estrangulado - constrangedoramente - com um novelo de l√£."
		],
		solucao: ["s3", "a3", "l1"]
	},
	{
		titulo: "ASSASSINATO EM HOLLYWOOD",
		enredo:
			"Quando Deductive Logico foi convidado para um jantar chique em uma mans√£o em Hollywood Hills, ele pensou que finalmente tinha conseguido. Infelizmente, ele n√£o era o convidado de honra: ele estava l√° para resolver o assassinato do convidado de honra.",
		suspeitos: [
			{
				nome: "O INCR√çVEL AUREOLIN",
				icone: "üé©",
				atributos: "1,63 metro - CANHOTO - OLHOS VERDES - CABELOS LOIROS",
				bio:
					"Uma m√°gica que aperfei√ßoou a rotina de serrar seu marido em dois. Ent√£o, ela fez seu corpo desaparecer."
			},
			{
				nome: "MIDNIGHT III",
				icone: "üëì",
				atributos:
					"1,60 metro ‚Äì CANHOTO - OLHOS CASTANHOS ESCUROS - CABELOS CASTANHOS ESCUROS",
				bio:
					"O neto do fundador da Midnight Movies e um autodescrito self-made man."
			},
			{
				nome: "DAMA OBSIDIAN",
				icone: "üëí",
				atributos: "1,63 metro ‚Äì Canhota ‚Äì Olhos verdes ‚Äì Cabelo preto",
				bio:
					"Uma escritora de mist√©rio cujos livros venderam mais c√≥pias do que a B√≠blia e Shakespeare juntos"
			}
		],
		locais: [
			{
				nome: "O ENORME BANHEIRO",
				icone: "üõÅ",
				ambiente: "INTERNO",
				descricao: "Um banheiro maior que a casa da Deductive Logico."
			},
			{
				nome: "O QUARTO",
				icone: "üõè",
				ambiente: "INTERNO",
				descricao:
					"Uma cama king size da Calif√≥rnia, desfeita, fica em um quarto branco imaculado."
			},
			{
				nome: "A SALA DE EXIBI√á√ÉO",
				icone: "üéâ",
				ambiente: "EXTERNO",
				descricao:
					"Assentos de veludo vermelho e uma m√°quina de pipoca fazem desta a melhor experi√™ncia de exibi√ß√£o."
			}
		],
		armas: [
			{
				nome: "UM GARFO",
				icone: "üç¥",
				peso: "LEVE",
				descricao:
					"Na verdade, muito mais horr√≠vel do que uma faca, se voc√™ pensar bem."
			},
			{
				nome: "UM CACHIMBO DE ALUM√çNIO",
				icone: "üî©",
				peso: "M√âDIO",
				descricao: "Mais seguro do que chumbo, a menos que atinja sua cabe√ßa."
			},
			{
				nome: "UMA VELA PESADA",
				icone: "üïØ",
				peso: "M√âDIO",
				descricao:
					"Pesada o suficiente para matar, mas ainda assim ilumina o quarto."
			}
		],
		pistas: [
			"O Incr√≠vel Aureolin confiou no suspeito que trouxe um garfo.",
			"Midnight III ainda estava brandindo um cachimbo de alum√≠nio quando Logico chegou.",
			"Uma vela pesada n√£o era encontrada no quarto.",
			"Dama Obsidian foi encontrada escondida sob assentos de veludo vermelho.",
			"O corpo foi encontrado dentro de uma banheira de m√°rmore."
		],
		solucao: ["s1", "a3", "l1"]
	}
];
const storyCaso1 = [
	`
Ap√≥s horas de investiga√ß√£o meticulosa, Logicus finalmente re√∫ne todas as pistas. O cheiro de am√™ndoa debaixo do vitral da capela, a aus√™ncia da Dama Obsidian, a paix√£o de Earl Grey por ch√° (e sua avers√£o a jardinagem), e a pesquisa da Di√°cona Verdigris nas ru√≠nas antigas come√ßam a se encaixar como pe√ßas de um quebra-cabe√ßa. Ele percebe que a resposta est√° nas pequenas incongru√™ncias e nos detalhes que passariam despercebidos para um observador menos atento.

Logicus convoca todos os suspeitos na mans√£o da Dama Obsidian, onde o vig√°rio foi encontrado morto. A atmosfera √© tensa, e os suspeitos trocam olhares desconfiados. Ele come√ßa a expor sua dedu√ß√£o:

<button id="next" onclick="Proxima1()">Pr√≥ximo</button>`,
	`"O vig√°rio foi estrangulado com um novelo de l√£, um m√©todo que exige for√ßa e precis√£o. No entanto, o verdadeiro mist√©rio n√£o √© como ele foi morto, mas por qu√™. E a resposta est√° no passado obscuro desta cidade e nas rela√ß√µes entre voc√™s."
<button id="next" onclick="Proxima1()">Pr√≥ximo</button>`,
	`Ele se volta para a Dama Obsidian, cuja aus√™ncia durante o crime chamou sua aten√ß√£o.
"Voc√™, Dama Obsidian, estava longe da mans√£o, mas n√£o por acaso. Voc√™ temia que o vig√°rio revelasse um segredo seu: a verdade sobre o desaparecimento de seu marido anos atr√°s. Ele descobriu que voc√™ o envenenou com cianureto, e voc√™ n√£o podia permitir que ele contasse a verdade."

A Dama Obsidian nega veementemente, mas Logicus continua:
"No entanto, voc√™ n√£o √© a assassina. O cheiro de am√™ndoa na capela foi uma pista falsa, plantada para incrimin√°-la. Algu√©m queria que voc√™ levasse a culpa."
<button id="next" onclick="Proxima1()">Pr√≥ximo</button>`,
	`Ele ent√£o olha para a Di√°cona Verdigris, que parece nervosa.
"Voc√™, Di√°cona, passou muito tempo nas ru√≠nas antigas, pesquisando pr√°ticas pag√£s. Mas seu interesse n√£o era acad√™mico. Voc√™ descobriu que o vig√°rio planejava fechar a capela e vender as terras da igreja, incluindo as ru√≠nas. Para voc√™, aquelas pedras eram sagradas, e voc√™ faria qualquer coisa para proteg√™-las. No entanto, voc√™ n√£o teria for√ßa suficiente para estrangular o vig√°rio com um novelo de l√£."
<button id="next" onclick="Proxima1()">Pr√≥ximo</button>`,
	`Finalmente, Logicus se volta para Earl Grey, que at√© ent√£o parecia calmo e distante.
"E voc√™, Earl Grey. Um homem de ch√°, n√£o de jardinagem. Mas h√° algo que voc√™ esconde. O novelo de l√£ n√£o era apenas uma arma; era um s√≠mbolo. O vig√°rio estava te chantageando, amea√ßando revelar que voc√™ falsificava a proced√™ncia de seus ch√°s para aumentar seus lucros. Ele sabia que isso arruinaria sua reputa√ß√£o e seu imp√©rio. Voc√™ o estrangulou com o novelo de l√£ em um momento de desespero, usando suas pr√≥prias m√£os para silenci√°-lo."
<button id="next" onclick="Proxima1()">Pr√≥ximo</button>`,
	`Earl Grey, pressionado, finalmente admite:
"Sim, foi eu. Ele estava prestes a destruir tudo o que constru√≠. Eu n√£o tive escolha."
<button id="next" onclick="Proxima1()">Pr√≥ximo</button>`,
	`Logicus entrega Earl Grey √†s autoridades, e a cidade finalmente descobre a verdade por tr√°s do assassinato do vig√°rio. A Dama Obsidian √© absolvida, mas sua reputa√ß√£o fica manchada pelos segredos revelados. A Di√°cona Verdigris, embora inocente do crime, decide deixar a cidade para refletir sobre suas a√ß√µes. E Earl Grey, o homem que herdou um legado de ch√° e tradi√ß√£o, v√™ seu imp√©rio desmoronar junto com sua liberdade.

Logicus, satisfeito por ter resolvido mais um mist√©rio, parte da cidade com uma nova li√ß√£o: at√© os crimes mais banais podem esconder hist√≥rias profundas e dolorosas. E, claro, ele leva consigo um saquinho de ch√° Earl Grey, um presente ir√¥nico do pr√≥prio assassino.

<a href="#titulo"><button onclick="proximoCaso()" >Pr√≥ximo CASO</button></a>`
];
const storyCaso2 = [
	`Logicus, ap√≥s analisar cuidadosamente as pistas e interrogar os suspeitos, re√∫ne todos na sala de exibi√ß√£o. Ele come√ßa a expor sua dedu√ß√£o, revelando os segredos ocultos por tr√°s do assassinato.

Logicus:
"O convidado de honra foi encontrado morto no enorme banheiro, um local que deveria ser de relaxamento, mas se tornou uma cena de crime. A arma do crime foi um objeto aparentemente comum, mas mortal nas m√£os certas: um garfo. E o assassino est√° entre n√≥s."
<button id="next" onclick="Proxima2()">Pr√≥ximo</button>`,
	`Ele se volta para O Incr√≠vel Aureolin, a ilusionista famosa por seus truques de desaparecimento.
"Voc√™, Aureolin, trouxe um garfo para o jantar. Um objeto que parece inofensivo, mas que pode ser letal. O garfo foi a arma perfeita para voc√™, que domina a arte da ilus√£o e do engano. Voc√™ usou o garfo para atacar a v√≠tima no banheiro, onde a √°gua mascararia qualquer ru√≠do e dificultaria a descoberta do crime. Mas por qu√™? Porque o convidado de honra estava prestes a revelar seu maior segredo: seus truques de m√°gica eram baseados em tecnologia roubada de um inventor rival. Se ele expusesse isso, sua carreira estaria arruinada."
<button id="next" onclick="Proxima2()">Pr√≥ximo</button>`,
	`Aureolin tenta protestar, mas Logicus continua:
"Voc√™ planejou tudo meticulosamente. Usou suas habilidades de ilusionista para distrair os outros convidados e garantir que ningu√©m suspeitasse de voc√™. No entanto, voc√™ esqueceu um detalhe crucial: o garfo que trouxe para o jantar foi encontrado perto do corpo, e suas digitais estavam nele."
<button id="next" onclick="Proxima2()">Pr√≥ximo</button>`,
	`Aureolin, pressionada, finalmente admite:
"Sim, foi eu. Ele ia destruir tudo o que constru√≠. Eu n√£o tinha escolha."
<button id="next" onclick="Proxima2()">Pr√≥ximo</button>`,
	`Logicus entrega O Incr√≠vel Aureolin √†s autoridades, e o glamour de Hollywood √© manchado por mais um esc√¢ndalo. Midnight III, embora envolvido em esquemas financeiros, escapa da acusa√ß√£o de assassinato, mas sua reputa√ß√£o fica abalada. Dama Obsidian, que estava escondida sob os assentos de veludo vermelho, revela-se inocente, mas decide usar o caso como inspira√ß√£o para seu pr√≥ximo livro.

Logicus, enquanto deixa a mans√£o, reflete sobre o pre√ßo da fama e do sucesso. Ele pega uma pipoca da m√°quina da sala de exibi√ß√£o, um √∫ltimo toque ir√¥nico de Hollywood, e parte para seu pr√≥ximo caso.
`
];

let casoAtual = 0;
function carregarCaso() {
	const caso = casos[casoAtual];
	document.getElementById("titulo").textContent = caso.titulo;
	document.getElementById("enredo").textContent = caso.enredo;

	for (let i = 0; i < 3; i++) {
		//suspeitos
		document.getElementById("S" + parseInt(i + 1) + "_icone").textContent =
			caso.suspeitos[i].icone;
		document.getElementById("suspeito" + parseInt(i + 1)).textContent =
			caso.suspeitos[i].nome;
		document.getElementById("S" + parseInt(i + 1) + "_bio").textContent =
			caso.suspeitos[i].bio;
		document.getElementById("S" + parseInt(i + 1) + "_atributos").textContent =
			caso.suspeitos[i].atributos;
		//locais
		document.getElementById("L" + parseInt(i + 1) + "_icone").textContent =
			caso.locais[i].icone;
		document.getElementById("local" + parseInt(i + 1)).textContent =
			caso.locais[i].nome;
		document.getElementById("L" + parseInt(i + 1) + "_ambiente").textContent =
			caso.locais[i].ambiente;
		document.getElementById("L" + parseInt(i + 1) + "_descricao").textContent =
			caso.locais[i].descricao;
		//armas
		document.getElementById("A" + parseInt(i + 1) + "_icone").textContent =
			caso.armas[i].icone;
		document.getElementById("arma" + parseInt(i + 1)).textContent =
			caso.armas[i].nome;
		document.getElementById("A" + parseInt(i + 1) + "_peso").textContent =
			caso.armas[i].peso;
		document.getElementById("A" + parseInt(i + 1) + "_descricao").textContent =
			caso.armas[i].descricao;

		//tabela
		document.getElementById("S" + parseInt(i + 1) + "_icone_tb").textContent =
			caso.suspeitos[i].icone;
		document.getElementById("S" + parseInt(i + 1) + "_icone_tb2").textContent =
			caso.suspeitos[i].icone;
		document.getElementById("A" + parseInt(i + 1) + "_icone_tb").textContent =
			caso.armas[i].icone;
		document.getElementById("A" + parseInt(i + 1) + "_icone_tb2").textContent =
			caso.armas[i].icone;
		document.getElementById("L" + parseInt(i + 1) + "_icone_tb").textContent =
			caso.locais[i].icone;
		document.getElementById("L" + parseInt(i + 1) + "_icone_tb2").textContent =
			caso.locais[i].icone;

		//op√ß√µes
		document.getElementById("suspeito" + parseInt(i + 1) + "_op").textContent =
			caso.suspeitos[i].nome;
		document.getElementById("arma" + parseInt(i + 1) + "_op").textContent =
			caso.armas[i].nome;
		document.getElementById("local" + parseInt(i + 1) + "_op").textContent =
			caso.locais[i].nome;
	}

	let pistas = document.getElementById("pistas");
	pistas.innerHTML = "";
	const ul = document.createElement("ul");
	for (let i = 0; i < caso.pistas.length; i++) {
		const li = document.createElement("li");
		li.textContent = caso.pistas[i];
		ul.appendChild(li);
	}
	pistas.appendChild(ul);

	solucao = {
		suspeito: caso.solucao[0],
		arma: caso.solucao[1],
		local: caso.solucao[2]
	};
}
let solucao = {
	suspeito: "",
	arma: "",
	local: ""
};

// Inicializa√ß√£o do jogo
function initGame() {
	carregarCaso();
}

let tentativas = 3;
// Verificar palpite
document.getElementById("submit-guess").addEventListener("click", () => {
	const suspeito = document.getElementById("suspect").value;
	const arma = document.getElementById("weapon").value;
	const local = document.getElementById("location").value;

	if ( suspeito=="" || arma=="" || local=="") {
		showResult("Erro", "Por favor, selecione todas as op√ß√µes!");
		return;
	}

	const isCorrect =
		suspeito === solucao.suspeito &&
		arma === solucao.arma &&
		local === solucao.local;

	if (isCorrect) {
		document.getElementById("btnPular").style = "display:inline-block;";
		if (casoAtual == 0) {
			showResult("Parab√©ns!", storyCaso1[0]);
		} else {
			showResult("Parab√©ns!", storyCaso2[0]);
		}
		//showResult("Parab√©ns!", "Voc√™ resolveu o caso corretamente!");
	} else {
		document.getElementById("btnPular").style = "display:none;";
		showResult("Incorreto", msgTentativas());
		tentativas--;
	}
});

function showResult(title, message) {
	typeWriter(message);
	document.getElementById("result-title").textContent = title;
	document.getElementById("result-message").textContent = message;
	document.getElementById("result-modal").style.display = "flex";
}

document.getElementById("close-modal").addEventListener("click", () => {
	document.getElementById("result-modal").style.display = "none";
});

// Iniciar o jogo
initGame();

// Fun√ß√£o para carregar estado salvo do localStorage
function loadState(tableId) {
	const savedData = JSON.parse(localStorage.getItem(tableId) || "{}");
	const table = document.getElementById(tableId);
	if (!table) return;

	const cells = table.querySelectorAll("tbody td");
	cells.forEach((cell) => {
		const row = cell.getAttribute("data-row");
		const col = cell.getAttribute("data-col");
		const key = row + "|" + col;

		if (savedData[key]) {
			// Aplica a classe correspondente
			cell.classList.add(savedData[key]);
			cell.textContent =
				savedData[key] === "cell-check"
					? "‚úì"
					: savedData[key] === "cell-x"
					? "‚úó"
					: "";
		}
	});
}

// Fun√ß√£o para salvar estado no localStorage
function saveState(tableId) {
	const table = document.getElementById(tableId);
	if (!table) return;

	const cells = table.querySelectorAll("tbody td");
	const dataToSave = {};

	cells.forEach((cell) => {
		const row = cell.getAttribute("data-row");
		const col = cell.getAttribute("data-col");
		const key = row + "|" + col;

		if (cell.classList.contains("cell-check")) {
			dataToSave[key] = "cell-check";
		} else if (cell.classList.contains("cell-x")) {
			dataToSave[key] = "cell-x";
		} else if (cell.classList.contains("")) {
			dataToSave[key] = "";
		}
	});

	localStorage.setItem(tableId, JSON.stringify(dataToSave));
}

// Fun√ß√£o para RESETAR estado no localStorage
function ResetSaveState(tableId) {
	const table = document.getElementById(tableId);
	if (!table) return;

	const cells = table.querySelectorAll("tbody td");
	const dataToSave = {};

	cells.forEach((cell) => {
		cell.textContent = "";
		cell.classList.remove("cell-check");
		cell.classList.remove("cell-x");
	});
	saveState(tableId);
}

// Fun√ß√£o para alternar estado da c√©lula
function toggleCell(cell) {
	if (cell.classList.contains("cell-check")) {
		// Se j√° √© check, passa para X
		cell.classList.remove("cell-check");
		cell.classList.add("cell-x");
		cell.textContent = "‚úó";
	} else if (cell.classList.contains("cell-x")) {
		// Se j√° √© X, limpa
		cell.classList.remove("cell-x");
		cell.textContent = "";
	} else {
		// Se est√° vazio, vira check
		cell.classList.add("cell-check");
		cell.textContent = "‚úì";
	}
}

// Inicializa√ß√£o
document.addEventListener("DOMContentLoaded", () => {
	const tables = [
		"grid-suspeitos-armas",
		"grid-suspeitos-locais",
		"grid-armas-locais"
	];

	// Carrega estado salvo para cada tabela
	tables.forEach((tableId) => {
		loadState(tableId);

		// Adiciona listener de clique
		const table = document.getElementById(tableId);
		if (table) {
			table.querySelectorAll("tbody td").forEach((cell) => {
				cell.addEventListener("click", () => {
					toggleCell(cell);
					saveState(tableId);
				});
			});
		}
	});

	// Bot√£o de reiniciar
	const resetBtn = document.getElementById("reset-btn");
	resetBtn.addEventListener("click", () => {
		if (confirm("Tem certeza de que deseja reiniciar o jogo?")) {
			// Limpa localStorage
			tables.forEach((tableId) => {
				ResetSaveState(tableId);
			});

			tables.forEach((tableId) => {
				localStorage.removeItem(tableId);
			});
		}
	});
});

let index = 0;
let timeoutIds = [];

function typeWriter(storyText) {
	const storyElement = document.getElementById("result-message");

	// Limpa todos os timeouts anteriores (caso a fun√ß√£o seja chamada novamente)
	clearAllTimeouts();

	if (index < storyText.length) {
		storyElement.innerHTML =
			storyText.substring(0, index) + '<span class="cursor"></span>';
		index++;
		const timeoutId = setTimeout(() => typeWriter(storyText), 50);
		timeoutIds.push(timeoutId); // Armazena o ID do timeout
	} else {
		storyElement.innerHTML = storyText;
		index = 0;
		timeoutIds = []; // Limpa os IDs quando a anima√ß√£o termina
	}
}

// Fun√ß√£o para pular a anima√ß√£o

document.getElementById("btnPular").addEventListener("click", () => {
	pular();
});
function pular() {
	const storyElement = document.getElementById("result-message");
	const currentText = storyElement.textContent; // Pega o texto sem as tags HTML

	// Limpa todos os timeouts pendentes
	clearAllTimeouts();

	// Exibe o texto completo (remove o cursor)
	storyElement.innerHTML = currentText;
	index = 0;
	timeoutIds = [];
	if (casoAtual == 0) {
		storyElement.innerHTML = storyCaso1[storyCaso1.length - 1];
	} else {
		storyElement.innerHTML = storyCaso2[storyCaso2.length - 1];
	}
}

// Fun√ß√£o para limpar todos os timeouts
function clearAllTimeouts() {
	timeoutIds.forEach((id) => clearTimeout(id));
	timeoutIds = [];
}

function Proxima1() {
	proximaPagina(storyCaso1);
}
function Proxima2() {
	proximaPagina(storyCaso2);
}

let paginaST1 = 0;
function proximaPagina(story) {
	if (story.length <= paginaST1 + 1) {
		paginaST1 = 0;
		return;
	} else {
		paginaST1++;
		typeWriter(story[paginaST1]);
	}
}
function proximoCaso() {
	casoAtual++;
	if (casoAtual >= casos.length) {
		return;
	} else {
		carregarCaso();
		document.getElementById("result-modal").style.display = "none";
		resetar();
	}
}
function limparSelects() {
	document.getElementById("suspect").selectedIndex = 0;
	document.getElementById("weapon").selectedIndex = 0;
	document.getElementById("location").selectedIndex = 0;
}

// Exemplo: Adicionando ao bot√£o de submiss√£o para resetar os selects ap√≥s enviar o palpite
document.getElementById("submit-guess").addEventListener("click", function () {
	limparSelects();
});

function resetar() {
	const tables = [
		"grid-suspeitos-armas",
		"grid-suspeitos-locais",
		"grid-armas-locais"
	];
	// Limpa localStorage
	tables.forEach((tableId) => {
		ResetSaveState(tableId);
	});

	tables.forEach((tableId) => {
		localStorage.removeItem(tableId);
	});
}

function getSelectedIndex(elementId) {	
	return parseInt(document.getElementById(elementId).value.slice(1)) - 1;
}
function msgTentativas() {
	const suspeitoIndex = getSelectedIndex("suspect");
	const armaIndex = getSelectedIndex("weapon");
	const localIndex = getSelectedIndex("location");

	const caso = casos[casoAtual];

	const suspeito = caso.suspeitos[suspeitoIndex].nome;
	const arma = caso.armas[armaIndex].nome;
	const local = caso.locais[localIndex].nome;

	let msg;
	if (tentativas == 3) {
		msg = `O detetive ajusta sua lupa e revisa suas anota√ß√µes... Mas opa! Nada conecta o(a) suspeito(a) ${suspeito} com a arma ${arma} e o local ${local}. Uma dedu√ß√£o desastrosa! Ele recebe uma advert√™ncia e √© aconselhado a voltar √† tabela de dedu√ß√µes para evitar mais gafes dignas de um estagi√°rio de investiga√ß√£o.`;
	}

	if (tentativas == 2) {
		msg = `Dram√°tico e confiante, o detetive aponta para ${suspeito} e declara: "Foi voc√™!" Mas... o local ${local} n√£o faz sentido, a arma ${arma} tamb√©m n√£o encaixa, e no fim das contas, nada se conecta! O j√∫ri n√£o perdoa, e o detetive √© preso por difama√ß√£o. Se quiser recuperar sua credibilidade, volte √† tabela de dedu√ß√µes e resolva esse caso com l√≥gica!`;
	}

	if (tentativas == 1) {
		msg = `Ap√≥s uma sequ√™ncia de erros vergonhosos, o detetive faz sua √∫ltima aposta... e falha miseravelmente! Sua reputa√ß√£o despenca mais r√°pido que um vil√£o de filme de a√ß√£o em um pr√©dio sem paraquedas. O tribunal n√£o perdoa: pena de morte! Agora, suas dedu√ß√µes s√£o feitas no al√©m, volte a tabela de dedu√ß√µes e complete. Quem sabe l√° no c√©u ele finalmente resolva um caso direito?`;
	}
	if (tentativas < 1) {
		msg = `O detetive errou de novo, mas ele est√° no c√©u, agora suas dedu√ß√µes s√£o infinitas, infinitos erros?`;
	}

	return msg;
}